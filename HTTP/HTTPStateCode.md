# HTTP 상태코드
<pre>
<b>HTTP 상태코드란?</b>
- 클라이언트가 보낸 요청의 처리의 <b>상태를 응답</b>해주는 코드
</pre>
## `1xx - 요청 처리중`
<pre>
<b>1xx (Informational) : 요청이 수신되어 처리중일 때 사용</b>
- 거의 사용되지 않음
</pre>
## `2xx - 성공`
<pre>
<b>2xx (Successful) : 요청 정상 처리</b>
- <b>200 OK</b> : 결과를 정상적으로 처리

- <b>201 Created</b> : 요청 성공해서 새로운 리소스가 생성됨
  • post 요청에 대한 응답으로 Location 에 생성된 리소스의 url를 삽입

- <b>202 Accepted</b> : 요청이 접수되었으나 처리가 완료되지 않았음 -> 배치 처리 같은곳에서 사용
  • 요청을 하고 나중에 한번에 처리하는 것

- <b>204 No Content</b> : 서버가 요청을 성공적으로 수행했지만, 응답 페이로드 본문에 보낼 데이터가 없을 때 204 메시지만으로 성공만을 인식한다.
</pre>
## `3xx - 리다이렉션`
<pre>
<b>3xx (Redirection) : 요청을 완료하려면 추가 작업이 필요</b>
- 리다이렉션 : <b>웹 브라우저는 3xx 응답의 결과에 Location 헤더가 있으면, Location 위치로 자동 이동(리다이렉트)</b>
- 리다이렉션 이해
  <img src="https://github.com/RyuKyeongWoo/TIL/blob/main/HTTP/img/Redirection.PNG"/>

<b>영구 리다이렉션</b> : 특정 리소스의 URI가 영구적으로 이동 -> EX) /event -> /new-event
- 원래의 URL을 사용하지 않음, 검색 엔진 등에서도 변경 인지
- <b>301 Moved Permanently</b> : 리다이렉트시 요청 메서드가 <b>GET으로 변하고 본문(Body)이 제거될 수 있음(MAY)</b>
- <b>308 Permanent Redirect</b> : 리다이렉트시 요청 메서드와 <b>본문(Body)을 유지 (301의 본문 제거 문제를 해결 함 하지만 보통 301을 쓴다)</b>


<b>일시적인 리다이렉션</b> : 일시적인 변경 -> EX) 주문 완료 후 주문 내역화면으로 이동, <b>PRG: Post/Redirect/Get</b>
- 일시적으로 변경되기 때문에 검색 엔진 등에서 URL을 변경하면 안된다.
- <b>302 Found</b> : 리다이렉트시 요청 메서드가 <b>대부분 GET으로 변하고 본문(Body)이 제거될 수 있음</b>
- <b>303 See Other</b> : 302와 기능은 동일, 리다이렉트시 요청 <b>메서드와 본문(Body) 유지 ( 요청 메서드를 변경하면 안된다.)</b>
- <b>307 Temporary Redirect</b> : 302와 기능은 동일, 리다이렉트시 요청 메서드가 <b>GET으로 변경</b>

<b>일시적인 리다이렉션은 어디서 사용될까?</b>
- <b>문제</b> : POST로 주문을 했을 때 브라우저가 새로고침이 되면 POST가 한번 더 요청 될 수 있다. -> 중복 주문이 될 수 있다.
- <b>해결</b> : <b>서버에서 중복 방지 로직을 작성</b> 또는 <b>PRG(Post-Redirect-Get) 패턴을 사용</b>한다.
- <b>결과</b> : POST로 주문후에 주문 결과 화면을 GET 메서드로 리다이렉트 하게 되면 새로 고침 해도 GET으로 결과 화면만 조회한다.
  <img src="https://github.com/RyuKyeongWoo/TIL/blob/main/HTTP/img/PRG.PNG"/>

<b>PRG (Post/Redirect/Get) 패턴이란?</b>
- 웹 개발 시에 권장되는 디자인 패턴 중 하나
- <b>HTTP POST 요청에 대한 응답이 또 다른 URL로의 GET 요청을 위한 리다이렉트(응답 코드가 3XX)여야 한다는 것</b>을 의미
- 일반적인 HTTP GET 요청처럼 HTTP POST 요청에 대한 응답이 어떠한 페이지를 직접 반환하는 것은 권장되지 않는 위험한 방식이라는 것이다.

<b>비슷한 기능이 많은데 어떤걸 써야할까?</b>
- 302 HTTP 스펙의 의도는 HTTP 메서드를 유지하는 것이나 브라우저들이 GET으로 바꿔버리고 일부는 다르게 동작한다.
- 그렇기 떄문에 명확한 307, 303이 등장, 하지만 현실적으로 이미 많은 애플리케이션 라이브러리들이 302를 기본값으로 사용
- 결론 : <b>GET 메서드가 변하는게 상관이 없으면 302를 사용해도 문제가 없다.</b>


<b>특수 리다이렉션</b> : 결과 대신 캐시를 사용 -> EX) 클라이언트의 캐시가 만료되어 서버에게 캐시 확인 요청 해줌
- <b>300 Multiple Choices</b> : 안쓴다.
- <b>304 Not Modified</b> : 캐시를 목적으로 사용
  • 클라이언트에게 리소스가 수정되지 않았음을 알려준다. 따라서 클라이언트는 로컬PC에 저장된 캐시를 재사용! -> 캐시로 리다이렉트 한다.
  • 로컬 캐시를 사용하기 때문에 응답에 메시지 바디를 포함하면 안된다.
  • 조건부 GET, HEAD 요청시 사용한다.
  • <b>예를들어</b>
    1. 클라이언트가 자신의 파일의 수정정보를 주면서 변경되었는지 확인하려고 서버에게 요청한다.
    2. 서버는 해당 파일의 수정정보가 변경되지 않았음을 감지하고 304 코드를 보내서 클라이언트가 해당 파일을 그대로 사용할 수 있게 한다.
</pre>
## `4xx - 클라이언트 오류`
<pre>
<b>4xx (Client Error) : 클라이언트 오류, 잘못된 문법등으로 서버가 요청 수행할 수 없음</b>
- 클라이언트가 잘못된 요청 또는 데이터를 보내고 있기 때문에 재시도 해도 실패
- <b>400 Bad Request</b> : 클라이언트가 잘못된 요청을 해서 서버가 요청을 처리할 수 없음(요청 파라미터나 API 스펙이 맞지 않을 때)

- <b>인증과 인가의 차이점</b>
  • 인증(Authentication) : 본인이 누구인지 확인, (로그인) -> <b>비인증 시 401 Unauthorized</b>
  • 인가(Authorization) : 권한부여 (특정 리소스에 접근할 수 있는 권한, 인증이 있어야 인가가 있음) -> <b>비인가 시 403 Forbiden</b>

- <b>401 Unauthorized</b> : 클라이언트가 해당 리소스에 대한 인증이 필요함
  • 인증(Authentication) 되지 않음
  • 401 오류 발생시 응답에 WWW-Authenticate 헤더와 함께 인증 방법을 설명해주어야 한다.

- <b>403 Forbiden</b> : 서버가 요청을 이해했지만 승인을 거부함
  • 주로 인증 자격 증명은 있지만, 접근 권한이 불충분한 경우

- <b>404 Not Found</b> : 요청 리소스를 찾을 수 없음
  • 요청 리소스가 서버에 없음
  • 또는 클라이언트가 권한이 부족한 리소스에 접근할 때 해당 리소스를 숨기고 싶을 때 사용
</pre>
## `5xx - 서버 오류`
<pre>
<b>5xx (Server Error) : 서버 오류, 정상 요청 처리하지 못함</b>
- 서버에 문제로 오류 발생
- <b>500 Internal Server Error</b> : 서버 문제로 오류 발생, 애매하면 500 오류

- <b>503 Service Unavailable</b> : 서비스 이용 불가
  • 서버가 일시적인 과부하 또는 예정된 작업으로 잠시 요청을 처리할 수 없음
  • Retry-After 헤더 필드로 얼마뒤에 복구되는지 보낼 수도 있음
</pre>
